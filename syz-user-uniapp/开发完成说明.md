# SYZ 用户系统开发完成说明

## 项目概述
基于数据库 shuangyinzi.sql 完成了 syz-user 后端和 syz-user-uniapp 前端的开发。

## 后端 (syz-user)

### 1. 实体类 (entity)
- `User.java` - 用户实体(已存在)
- `UserModal.java` - 用户模态关联(已存在)
- `ModalIdentifier.java` - 模态标识(已存在)
- `GridCode.java` - 网格码实体(新增)
- `TwoFactorCode.java` - 双因子码实体(新增)
- `ProjectInfo.java` - 项目信息实体(新增)
- `Diyiceng.java` - 第一层数据实体(新增)

### 2. Mapper 接口 (mapper)
- `UserMapper.java` - 用户数据访问(已存在)
- `GridCodeMapper.java` - 网格码数据访问(新增)
- `TwoFactorCodeMapper.java` - 双因子码数据访问(新增)
- `ModalIdentifierMapper.java` - 模态标识数据访问(新增)
- `ProjectInfoMapper.java` - 项目信息数据访问(新增)
- `DiyicengMapper.java` - 第一层数据访问(新增)

### 3. Service 层 (service)
- `UserService.java` - 用户业务逻辑(已存在)
- `SmsService.java` - 短信服务(已存在)
- `GridCodeService.java` - 网格码业务逻辑(新增)
- `CodeManagementService.java` - 码管理业务逻辑(新增)

### 4. Controller 层 (controller)
- `UserController.java` - 用户接口(已存在)
- `CodeManagementController.java` - 码管理接口(新增)

### 5. API 接口说明

#### 用户相关接口 (/user)
- `POST /user/sendCode` - 发送验证码
- `POST /user/register` - 用户注册
- `POST /user/login` - 用户登录
- `POST /user/fillInfo` - 填写网格码信息
- `GET /user/{id}` - 获取用户信息
- `POST /user/updateModal` - 更新模态标识
- `POST /user/resetPassword` - 重置密码

#### 码管理接口 (/code)
- `POST /code/createTwoFactorCode` - 创建双因子码
- `POST /code/createModalIdentifier` - 创建模态标识
- `GET /code/modals` - 查询模态标识列表
- `GET /code/projects` - 查询项目列表
- `GET /code/userCodeInfo` - 获取用户码信息

## 前端 (syz-user-uniapp)

### 1. 目录结构
```
pages-user/
├── utils/
│   └── request.js          # 请求工具类
├── login/
│   └── login.vue          # 登录页面
├── register/
│   └── register.vue       # 注册页面
├── reset-password/
│   └── reset-password.vue # 重置密码页面
├── dashboard/
│   └── dashboard.vue      # 个人中心页面
├── fill-info/
│   └── fill-info.vue      # 填写信息页面
└── modal-binding/
    └── modal-binding.vue  # 资产确权页面
```

### 2. 页面说明

#### 登录页面 (login.vue)
- 手机号密码登录
- 表单验证
- JWT Token 认证
- 支持跳转注册和找回密码

#### 注册页面 (register.vue)
- 手机号注册
- 验证码验证
- 密码确认
- 自动生成双因子码

#### 重置密码页面 (reset-password.vue)
- 手机号验证
- 验证码验证
- 密码重置

#### 个人中心页面 (dashboard.vue)
- 显示用户基本信息
- 显示双因子码、网格码、模态标识
- 功能菜单入口
- 退出登录

#### 填写信息页面 (fill-info.vue)
- 填写网格码
- 开通网格权益

#### 资产确权页面 (modal-binding.vue)
- 绑定模态标识
- 查看绑定历史
- 资产确权功能

### 3. 特性
- **响应式设计**: 适配手机端和 PC 端
- **多端兼容**: 支持 H5、小程序、App 等多端运行
- **JWT 认证**: 使用 Token 进行身份验证
- **表单验证**: 完善的前端表单验证
- **错误处理**: 统一的错误提示
- **缓存管理**: 用户信息本地缓存

## 配置说明

### 后端配置
1. 确保 `application.properties` 中数据库配置正确
2. 确保阿里云短信服务配置正确
3. 后端默认端口: 8081

### 前端配置
1. 修改 `pages-user/utils/request.js` 中的 `BASE_URL` 为实际后端地址
   ```javascript
   const BASE_URL = 'http://localhost:8081/user'
   ```
2. 在 `pages.json` 中已配置所有页面路由

## 运行说明

### 后端运行
```bash
cd syz-user
mvn spring-boot:run
```

### 前端运行
1. 使用 HBuilderX 打开 syz-user-uniapp 目录
2. 选择运行到浏览器或其他平台
3. 或使用命令行:
```bash
cd syz-user-uniapp
npm run dev:h5
```

## 数据库表说明

### 用户相关表
- `user` - 用户表
- `user_modal` - 用户模态关联表

### 业务相关表
- `biz_grid_code` - 网格码表
- `biz_two_factor_code` - 双因子码表
- `biz_modal_identifier` - 模态标识表
- `biz_project_info` - 项目信息表
- `diyiceng` - 第一层数据表

### 管理员表
- `admin` - 管理员表

## 开发完成清单

### 后端
- [x] 创建数据库实体类
- [x] 创建 Mapper 接口
- [x] 创建 Service 层业务逻辑
- [x] 创建 Controller 层 API 接口

### 前端
- [x] 配置 pages.json 和路由
- [x] 创建 utils 工具类(request.js)
- [x] 创建登录页面(login)
- [x] 创建注册页面(register)
- [x] 创建重置密码页面(reset-password)
- [x] 创建个人中心页面(dashboard)
- [x] 创建填写信息页面(fill-info)
- [x] 创建资产确权页面(modal-binding)

## 注意事项

1. **跨域问题**: Controller 已添加 `@CrossOrigin` 注解支持跨域
2. **JWT Token**: 有效期为 7 天,需要在前端请求头中携带
3. **验证码**: 默认为 888888,生产环境需配置真实的阿里云短信服务
4. **响应式适配**: 所有页面已支持手机端和 PC 端响应式布局
5. **数据缓存**: 用户信息存储在本地 Storage 中,注意及时更新

## 技术栈

### 后端
- Spring Boot 3.x
- MyBatis-Plus
- MySQL
- JWT
- Redis
- 阿里云短信服务

### 前端
- uni-app
- Vue.js
- uni-ui 组件库
- CSS3 媒体查询(响应式)

## 联系方式
如有问题,请查看项目文档或联系开发团队。
