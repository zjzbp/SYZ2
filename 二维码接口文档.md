# 二维码生成接口文档

## 接口概述

本系统提供了二维码生成功能，支持生成普通二维码和带Logo的二维码。所有二维码默认跳转到登录页面 `http://localhost:5173/#/`

基础URL: `http://localhost:8081/qrcode`

---

## 1. 生成普通二维码（GET方式）

**接口地址**: `GET /qrcode/generate`

**功能说明**: 生成普通二维码图片

**请求参数**:
| 参数名 | 类型 | 必填 | 默认值 | 说明 |
|--------|------|------|--------|------|
| content | String | 否 | http://localhost:5173/#/ | 二维码内容/跳转链接 |
| width | Integer | 否 | 300 | 二维码宽度(px) |
| height | Integer | 否 | 300 | 二维码高度(px) |

**响应格式**: PNG图片

**请求示例**:
```
# 生成默认二维码（跳转到登录页）
GET http://localhost:8081/qrcode/generate

# 指定尺寸
GET http://localhost:8081/qrcode/generate?width=400&height=400

# 自定义内容
GET http://localhost:8081/qrcode/generate?content=https://www.example.com
```

**使用示例（HTML）**:
```html
<img src="http://localhost:8081/qrcode/generate" alt="登录二维码" />
<img src="http://localhost:8081/qrcode/generate?width=500&height=500" alt="大尺寸二维码" />
```

---

## 2. 生成带Logo的二维码（GET方式）

**接口地址**: `GET /qrcode/generate-with-logo`

**功能说明**: 生成带Logo的二维码图片，如果不提供Logo URL则使用默认蓝色圆形Logo

**请求参数**:
| 参数名 | 类型 | 必填 | 默认值 | 说明 |
|--------|------|------|--------|------|
| content | String | 否 | http://localhost:5173/#/ | 二维码内容/跳转链接 |
| width | Integer | 否 | 300 | 二维码宽度(px) |
| height | Integer | 否 | 300 | 二维码高度(px) |
| logoUrl | String | 否 | 默认Logo | Logo图片URL地址 |

**响应格式**: PNG图片

**请求示例**:
```
# 使用默认Logo
GET http://localhost:8081/qrcode/generate-with-logo

# 指定Logo URL
GET http://localhost:8081/qrcode/generate-with-logo?logoUrl=https://example.com/logo.png

# 自定义尺寸和Logo
GET http://localhost:8081/qrcode/generate-with-logo?width=400&height=400&logoUrl=https://example.com/logo.png
```

**使用示例（HTML）**:
```html
<img src="http://localhost:8081/qrcode/generate-with-logo" alt="带Logo的二维码" />
```

---

## 3. 生成登录页面二维码（快捷接口）

**接口地址**: `GET /qrcode/login`

**功能说明**: 快捷生成跳转到登录页面的二维码

**请求参数**:
| 参数名 | 类型 | 必填 | 默认值 | 说明 |
|--------|------|------|--------|------|
| withLogo | Boolean | 否 | false | 是否带Logo |

**响应格式**: PNG图片

**请求示例**:
```
# 普通登录二维码
GET http://localhost:8081/qrcode/login

# 带Logo的登录二维码
GET http://localhost:8081/qrcode/login?withLogo=true
```

**使用示例（HTML）**:
```html
<!-- 普通登录二维码 -->
<img src="http://localhost:8081/qrcode/login" alt="扫码登录" />

<!-- 带Logo的登录二维码 -->
<img src="http://localhost:8081/qrcode/login?withLogo=true" alt="扫码登录" />
```

---

## 4. 生成普通二维码（POST方式）

**接口地址**: `POST /qrcode/generate`

**功能说明**: 通过POST方式生成二维码，支持更复杂的内容（如包含特殊字符的长文本）

**请求头**:
```
Content-Type: application/json
```

**请求体**:
```json
{
  "content": "http://localhost:5173/#/",
  "width": 300,
  "height": 300
}
```

**响应格式**: PNG图片

**请求示例（curl）**:
```bash
curl -X POST http://localhost:8081/qrcode/generate \
  -H "Content-Type: application/json" \
  -d '{"content":"http://localhost:5173/#/","width":400,"height":400}' \
  --output qrcode.png
```

**请求示例（JavaScript）**:
```javascript
fetch('http://localhost:8081/qrcode/generate', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    content: 'http://localhost:5173/#/',
    width: 400,
    height: 400
  })
})
.then(response => response.blob())
.then(blob => {
  const url = URL.createObjectURL(blob);
  const img = document.createElement('img');
  img.src = url;
  document.body.appendChild(img);
});
```

---

## 5. 生成带Logo的二维码（POST方式）

**接口地址**: `POST /qrcode/generate-with-logo`

**功能说明**: 通过POST方式生成带Logo的二维码

**请求头**:
```
Content-Type: application/json
```

**请求体**:
```json
{
  "content": "http://localhost:5173/#/",
  "width": 300,
  "height": 300,
  "logoUrl": "https://example.com/logo.png"
}
```

**响应格式**: PNG图片

**请求示例（curl）**:
```bash
curl -X POST http://localhost:8081/qrcode/generate-with-logo \
  -H "Content-Type: application/json" \
  -d '{"content":"http://localhost:5173/#/","width":400,"height":400,"logoUrl":"https://example.com/logo.png"}' \
  --output qrcode-with-logo.png
```

**请求示例（JavaScript）**:
```javascript
fetch('http://localhost:8081/qrcode/generate-with-logo', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    content: 'http://localhost:5173/#/',
    width: 400,
    height: 400,
    logoUrl: 'https://example.com/logo.png'
  })
})
.then(response => response.blob())
.then(blob => {
  const url = URL.createObjectURL(blob);
  const img = document.createElement('img');
  img.src = url;
  document.body.appendChild(img);
});
```

---

## 常见使用场景

### 1. 使用本地Logo文件（推荐）

**第一步：准备Logo文件**

将你的Logo图片（如 `my-logo.png`）放到以下目录：
```
syz-user/src/main/resources/static/logos/
```

**第二步：调用接口**

```bash
# GET请求 - 使用本地Logo
http://localhost:8081/qrcode/generate-with-logo?logoUrl=my-logo.png

# 自定义尺寸
http://localhost:8081/qrcode/generate-with-logo?logoUrl=my-logo.png&width=500&height=500
```

```javascript
// POST请求 - 使用本地Logo
fetch('http://localhost:8081/qrcode/generate-with-logo', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    content: 'http://localhost:5173/#/',
    logoUrl: 'my-logo.png'  // 本地文件名
  })
})
```

### 2. 使用网络Logo URL

```bash
# 从网络URL加载Logo
http://localhost:8081/qrcode/generate-with-logo?logoUrl=https://example.com/logo.png
```

### 3. 使用默认Logo

```bash
# 不传logoUrl参数，使用默认蓝色圆形Logo
http://localhost:8081/qrcode/generate-with-logo
```

### 4. 在Vue/React项目中使用

```javascript
// 直接在img标签中使用
<template>
  <div>
    <h3>扫码登录</h3>
    <img :src="qrcodeUrl" alt="登录二维码" />
  </div>
</template>

<script>
export default {
  data() {
    return {
      qrcodeUrl: 'http://localhost:8081/qrcode/login?withLogo=true'
    }
  }
}
</script>
```

### 5. 在UniApp中使用

```vue
<template>
  <view>
    <image :src="qrcodeUrl" mode="aspectFit"></image>
  </view>
</template>

<script>
export default {
  data() {
    return {
      qrcodeUrl: 'http://localhost:8081/qrcode/login?withLogo=true'
    }
  }
}
</script>
```

### 6. 下载二维码

```javascript
// 下载二维码到本地
function downloadQrCode() {
  const url = 'http://localhost:8081/qrcode/generate-with-logo?width=500&height=500';
  const link = document.createElement('a');
  link.href = url;
  link.download = 'qrcode.png';
  link.click();
}
```

---

## 技术实现说明

- **二维码库**: Google ZXing
- **图片格式**: PNG
- **默认尺寸**: 300x300 像素
- **Logo尺寸**: 60x60 像素（居中放置）
- **容错等级**: H级（高容错，即使遮挡30%仍可扫描）
- **字符编码**: UTF-8
- **Logo支持**：
  - 本地文件：从 `resources/static/logos/` 目录加载
  - 网络URL：HTTP/HTTPS图片链接
  - 默认Logo：蓝色圆形Logo
  - 支持格式：PNG、JPG、JPEG、GIF

---

## 注意事项

1. **Logo大小**: Logo会自动缩放到60x60像素并居中放置
2. **二维码容错**: 使用H级容错，确保即使中心放置Logo也能正常扫描
3. **默认跳转**: 如果不指定content参数，默认跳转到 `http://localhost:5173/#/`
4. **图片格式**: 所有接口返回PNG格式图片
5. **跨域支持**: 接口已启用CORS，支持跨域请求
6. **Logo加载**: 如果提供的logoUrl无法访问，会自动使用默认蓝色圆形Logo
7. **本地Logo文件**: 
   - 将Logo文件放在 `syz-user/src/main/resources/static/logos/` 目录
   - 文件名不能包含中文或特殊字符
   - 文件名大小写敏感
   - 重新编译后生效
8. **网络Logo**: 支持HTTP/HTTPS链接，需要能公网访问

---

## 测试方法

### 浏览器直接访问
直接在浏览器中访问以下URL即可查看二维码：
```
http://localhost:8081/qrcode/login
http://localhost:8081/qrcode/login?withLogo=true
http://localhost:8081/qrcode/generate?width=500&height=500
```

### 使用Postman测试
1. 新建GET请求
2. 输入URL: `http://localhost:8081/qrcode/generate`
3. 点击Send
4. 在响应区域可以看到图片预览

### 手机扫码测试
1. 在浏览器中打开二维码接口
2. 使用手机微信扫一扫
3. 应该会跳转到 `http://localhost:5173/#/` 登录页面
