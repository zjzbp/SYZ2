# 项目启动指南

## 一、环境准备

### 1. 数据库配置
确保MySQL数据库已安装并运行，执行以下SQL脚本创建数据库和表：

```bash
# 导入数据库脚本
mysql -u root -p < shuangyinzi.sql
```

### 2. 后端配置
修改 `syz-user/src/main/resources/application.properties` 配置文件：

```properties
# 数据库配置 - 修改为你的数据库信息
spring.datasource.url=jdbc:mysql://192.168.1.142:3306/shuangyinzi?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai
spring.datasource.username=root
spring.datasource.password=Root@123456

# Redis配置 - 修改为你的Redis信息
spring.data.redis.host=localhost
spring.data.redis.port=6379
spring.data.redis.password=123456

# 阿里云短信配置（可选，开发环境可跳过）
aliyun.sms.access-key-id=your-access-key-id
aliyun.sms.access-key-secret=your-access-key-secret
```

## 二、启动后端服务

### 方式一：使用Maven命令
```bash
cd syz-user
mvn clean install
mvn spring-boot:run
```

### 方式二：使用IDE启动
1. 在IDEA中打开项目
2. 找到 `SyzUserApplication.java`
3. 右键 -> Run 'SyzUserApplication'

后端服务启动后访问地址：`http://localhost:8080`

## 三、启动前端页面

### 方式一：直接打开HTML
直接用浏览器打开 `syz-user-html/login.html`

### 方式二：使用HTTP服务器（推荐）
```bash
cd syz-user-html

# 使用Python启动
python -m http.server 8081

# 或使用Node.js的http-server
npx http-server -p 8081
```

前端访问地址：`http://localhost:8081`

## 四、功能测试流程

### 1. 注册新用户
1. 访问 `http://localhost:8081/register.html`
2. 输入手机号（如：13800138000）
3. 点击"发送验证码"
4. 输入验证码：**888888**（开发环境默认）
5. 设置密码（至少6位）
6. 点击"注册"

### 2. 用户登录
1. 访问 `http://localhost:8081/login.html`
2. 输入手机号和密码
3. 点击"登录"
4. 自动跳转到用户中心

### 3. 开通网格服务
1. 在用户中心点击"立即开通"
2. 输入网格码（测试用：GRID-TEST-001）
3. 点击"确认开通"

### 4. 绑定模态标识
1. 选择资产分类（如：口述历史）
2. 输入资产标识（如：HASH-12345）
3. 填写资产描述（如：张三的口述历史录音-2025）
4. 点击"提交确权绑定"

## 五、API接口说明

### 基础路径
```
http://localhost:8080/user
```

### 接口列表

#### 1. 发送验证码
```
POST /user/sendCode?phone=13800138000
```

#### 2. 用户注册
```
POST /user/register
Content-Type: application/json

{
  "username": "张三",
  "phone": "13800138000",
  "verifyCode": "888888",
  "password": "123456"
}
```

#### 3. 用户登录
```
POST /user/login
Content-Type: application/json

{
  "phone": "13800138000",
  "password": "123456"
}
```

#### 4. 获取用户信息
```
GET /user/{id}
Authorization: Bearer {token}
```

#### 5. 开通网格服务
```
POST /user/fillInfo
Content-Type: application/json
Authorization: Bearer {token}

{
  "userId": 1,
  "gridCode": "GRID-TEST-001"
}
```

#### 6. 绑定模态标识
```
POST /user/updateModal
Content-Type: application/json
Authorization: Bearer {token}

{
  "userId": 1,
  "type": "ORAL_HISTORY",
  "modalCode": "HASH-12345",
  "description": "张三的口述历史录音-2025"
}
```

#### 7. 重置密码
```
POST /user/resetPassword
Content-Type: application/json

{
  "phone": "13800138000",
  "verifyCode": "888888",
  "newPassword": "654321",
  "confirmPassword": "654321"
}
```

## 六、常见问题

### 1. 后端启动失败
- 检查MySQL是否启动
- 检查Redis是否启动
- 检查数据库配置是否正确
- 检查端口8080是否被占用

### 2. 前端无法访问后端
- 检查后端是否成功启动
- 检查浏览器控制台是否有跨域错误
- 确认API地址配置正确（js/common.js）

### 3. 验证码发送失败
- 开发环境直接使用默认验证码：888888
- 生产环境需配置阿里云短信服务

### 4. 登录后Token过期
- Token默认有效期7天
- 过期后需要重新登录
- 可在JwtUtil中修改过期时间

## 七、项目目录结构

```
SYZ/
├── syz-admin/                 # 后台管理模块（独立）
├── syz-user/                  # 用户服务后端 ✓
│   ├── src/main/java/
│   │   └── com/cuco/syzuser/
│   │       ├── config/        # 配置类
│   │       ├── controller/    # 控制器
│   │       ├── dto/           # 数据传输对象
│   │       ├── entity/        # 实体类
│   │       ├── mapper/        # MyBatis Mapper
│   │       ├── service/       # 服务层
│   │       └── util/          # 工具类
│   └── pom.xml
├── syz-user-html/             # 用户服务前端 ✓
│   ├── css/                   # 样式文件
│   ├── js/                    # JavaScript文件
│   ├── index.html             # 首页
│   ├── login.html             # 登录页
│   ├── register.html          # 注册页
│   ├── reset-password.html    # 重置密码页
│   ├── dashboard.html         # 用户中心
│   └── README.md              # 前端说明文档
├── syz-user-vue/              # Vue版本前端（参考）
├── vueprogect/                # Vue项目（参考）
├── shuangyinzi.sql            # 数据库脚本
└── pom.xml                    # 父级POM
```

## 八、技术栈

### 后端
- Spring Boot 3.x
- MyBatis + MyBatis-Plus
- MySQL 8.0
- Redis
- JWT
- 阿里云短信SDK

### 前端
- HTML5
- CSS3（响应式设计）
- JavaScript ES6+
- Fetch API

## 九、下一步开发建议

1. ✅ 完善用户权限管理
2. ✅ 添加数据分页功能
3. ✅ 集成文件上传功能
4. ✅ 添加操作日志记录
5. ✅ 优化错误处理和提示
6. ✅ 添加单元测试
7. ✅ 部署到生产环境

## 十、联系方式

如有问题，请查看项目相关文档或联系开发团队。
